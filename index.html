<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mirror â€“ Ã†rlig Feedback</title>
  <style>
    body {
      margin: 0;
      background: #0a0a0a;
      color: white;
      font-family: sans-serif;
      text-align: center;
    }
    header {
      padding: 20px;
      background: #111;
      box-shadow: 0 0 10px #000;
    }
    h1 {
      margin: 0;
      font-size: 28px;
    }
    .container {
      padding: 20px;
    }
    textarea, input[type="file"] {
      width: 90%;
      background: #222;
      color: white;
      border: 1px solid #555;
      border-radius: 8px;
      padding: 10px;
      font-size: 16px;
      margin-top: 10px;
    }
    button {
      margin-top: 10px;
      padding: 10px 24px;
      font-size: 16px;
      border: none;
      background: #28a745;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }
    .feedback-box, .history-box {
      margin-top: 30px;
      background: #1a1a1a;
      padding: 20px;
      border-radius: 10px;
    }
    input[type=number] {
      width: 60px;
      padding: 6px;
      font-size: 16px;
      border: 1px solid #555;
      border-radius: 5px;
      background: #222;
      color: white;
    }
    footer {
      margin-top: 40px;
    }
    .socials img {
      width: 40px;
      margin: 10px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .socials img:hover {
      transform: scale(1.1);
    }
    img.uploaded-img {
      max-width: 300px;
      margin-top: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸªž Mirror â€“ Ã†rlig og anonym feedback</h1>
  </header>

  <div class="container">
    <h2>1. Del en idÃ©, bilde eller tekst</h2>
    <textarea id="postText" placeholder="Skriv din idÃ©..."></textarea>
    <br>
    <input type="file" id="postImage" accept="image/*">
    <br>
    <button onclick="submitPost()">Post</button>

    <div class="feedback-box">
      <h2>2. Gi Ã¦rlig feedback</h2>
      <div id="randomPost"></div>
      <label for="score">Score (1â€“10):</label>
      <input type="number" id="score" min="1" max="10" value="5" />
      <br><br>
      <textarea id="feedbackText" placeholder="Hvordan kan det bli bedre?"></textarea>
      <br>
      <button onclick="submitFeedback()">Send feedback</button>
    </div>

    <div class="history-box">
      <h2>Dine innsendte poster & feedback</h2>
      <div id="postHistory"></div>
    </div>
  </div>

  <footer>
    <h3>Support our socials</h3>
    <div class="socials">
      <a href="https://www.youtube.com/@TurboTalesnrwy" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg" alt="YouTube" />
      </a>
      <a href="https://www.tiktok.com/@turbotales02" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/en/0/0a/TikTok_logo.svg" alt="TikTok" />
      </a>
    </div>
  </footer>

  <script>
    let posts = JSON.parse(localStorage.getItem("mirror_posts")) || [];

    function submitPost() {
      const text = document.getElementById("postText").value;
      const imgInput = document.getElementById("postImage");
      const reader = new FileReader();

      reader.onload = function(e) {
        const imgData = imgInput.files.length > 0 ? e.target.result : null;
        const post = { text, img: imgData, feedback: [] };
        posts.push(post);
        localStorage.setItem("mirror_posts", JSON.stringify(posts));
        alert("Innlegg postet!");
        location.reload();
      };

      if (imgInput.files.length > 0) {
        reader.readAsDataURL(imgInput.files[0]);
      } else {
        reader.onload();
      }
    }

    function getRandomPost() {
      if (posts.length === 0) return "Ingen innlegg ennÃ¥.";
      const idx = Math.floor(Math.random() * posts.length);
      const post = posts[idx];
      let html = `<blockquote>"${post.text}"</blockquote>`;
      if (post.img) {
        html += `<img src="${post.img}" class="uploaded-img" />`;
      }
      html += `<input type='hidden' id='currentPostIndex' value='${idx}'>`;
      document.getElementById("randomPost").innerHTML = html;
    }

    function submitFeedback() {
      const index = document.getElementById("currentPostIndex").value;
      const score = document.getElementById("score").value;
      const text = document.getElementById("feedbackText").value;
      if (!posts[index].feedback) posts[index].feedback = [];
      posts[index].feedback.push({ score, text });
      localStorage.setItem("mirror_posts", JSON.stringify(posts));
      alert("Feedback sendt!");
      getRandomPost();
    }

    function renderPostHistory() {
      let html = "";
      posts.forEach((post, i) => {
        html += `<div style='margin-bottom:20px;'>
          <strong>${post.text}</strong><br>`;
        if (post.img) {
          html += `<img src='${post.img}' class='uploaded-img'><br>`;
        }
        if (post.feedback && post.feedback.length > 0) {
          html += `<em>Feedback mottatt:</em><ul>`;
          post.feedback.forEach(f => {
            html += `<li>${f.score}/10 â€“ ${f.text}</li>`;
          });
          html += `</ul>`;
        }
        html += `</div>`;
      });
      document.getElementById("postHistory").innerHTML = html;
    }

    getRandomPost();
    renderPostHistory();
  </script>
</body>
</html>
